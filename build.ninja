cxx = clang++
cflags = -O1 -fPIC -pipe -fno-strict-aliasing -Icore -Iedit -I.
ldflags = -L. -Lcore -Ledit -L.

rule compile
  command = $cxx -c $cflags -o $out $in
rule build-exe
  command = $cxx -o $out $in $ldflags

build core/core.o: compile core/lib.cpp | core/core.hpp core/types.hpp core/lib.cpp core/slice.hpp core/assert.cpp
build edit/edit.o: compile edit/lib.cpp | edit/lib.cpp edit/editor.cpp
build ./smol-editor: build-exe ./main.cpp core/core.o edit/edit.o | buildgen.py ./main.cpp
